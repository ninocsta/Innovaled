{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-light mb-4">ðŸ“… Contratos Vencendo</h2>

    {% if contratos %}
    <div class="table-responsive">
        <table class="table table-dark table-striped table-hover align-middle">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Cliente</th>
                    <th>Data de Vencimento</th>
                    <th>Dias Restantes</th>
                    <th>AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody>
                {% for contrato in contratos %}
                <tr class="{% if contrato.data_vencimento_contrato <= hoje %}table-danger{% endif %}">
                    <td>#{{ contrato.id_contrato|stringformat:"05d" }}</td>
                    <td>{{ contrato.cliente.razao_social }}</td>
                    <td>{{ contrato.data_vencimento_contrato|date:"d/m/Y" }}</td>
                    <td>
                        {% if contrato.data_vencimento_contrato %}
                            {{ contrato.data_vencimento_contrato|timeuntil:hoje }}
                        {% else %}
                            ---
                        {% endif %}
                    </td>
                    <td>
                        <form method="post" action="{% url 'renovar_contrato' contrato.id_contrato %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-sm btn-success">ðŸ”„ Renovar +30 dias</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-success">ðŸŽ‰ NÃ£o hÃ¡ contratos vencendo.</div>
    {% endif %}
</div>
{% endblock %}
